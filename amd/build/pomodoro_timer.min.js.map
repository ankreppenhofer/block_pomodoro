{"version":3,"file":"pomodoro_timer.min.js","sources":["../src/pomodoro_timer.js"],"sourcesContent":["/**\n * Pomodoro Timer (AMD) â€” scoped by course, increments only when focus ends.\n * WS: block_pomodoro_increment_session(courseid:int, startts:int [UNIX seconds])\n *     block_pomodoro_get_status(courseid:int)\n */\ndefine(['core/ajax', 'core/notification'], function (Ajax, Notification) {\n    'use strict';\n\n    const $ = (id) => document.getElementById(id);\n    const now = () => Date.now();\n    const readInt = (v, d) => { const n = parseInt(v ?? '', 10); return Number.isFinite(n) ? n : d; };\n    const fmt = (ms) => { const s = Math.max(0, Math.floor(ms/1000)); const m = Math.floor(s/60).toString().padStart(2,'0'); const r = (s%60).toString().padStart(2,'0'); return `${m}:${r}`; };\n\n    const scoped = (courseid) => {\n        const cid = Number.isFinite(courseid)&&courseid>0 ? courseid : 'global';\n        const p = `pomodoro:${cid}`;\n        return {\n            END: `${p}:endTimestamp`, RUNNING:`${p}:running`, PHASE:`${p}:phase`,\n            BREAKKIND:`${p}:breakKind`, MSG:`${p}:msg`, CHANNEL:`${p}:channel`,\n        };\n    };\n\n    const renderTomatoes = (el, sessionscount, interval) => {\n        if (!el) return;\n        const n = Math.max(0, sessionscount|0);\n        const m = Math.max(1, interval|0);\n        const filled = ((n % m) === 0 && n !== 0) ? m : (n % m); // show full row on the long-break step\n        const items = Array.from({length:m}, (_,i) =>\n            `<span class=\"tomato ${i<filled?'filled':''}\" aria-hidden=\"true\"></span>`\n        ).join('');\n        el.innerHTML = items;\n    };\n\n    return {\n        init() {\n            const display = $('pomodoro-timer-display');\n            if (!display) return;\n\n            const courseid = readInt(display.getAttribute('data-courseid'), 0);\n            const K = scoped(courseid);\n\n            const wellnessSec = readInt(display.getAttribute('data-wellness-sec'), 30);\n            let focusMs;\n            const focusSec = readInt(display.getAttribute('data-focus-sec'), NaN);\n            if (Number.isFinite(focusSec)) focusMs = focusSec*1000;\n            else {\n                let focusMin = readInt(display.getAttribute('data-focus-min'), NaN);\n                if (!Number.isFinite(focusMin)) {\n                    const dur = display.getAttribute('data-duration') || '25:00';\n                    const [mm='25'] = dur.split(':'); focusMin = readInt(mm,25);\n                }\n                focusMs = focusMin*60*1000;\n            }\n            let shortbreakMs, longbreakMs;\n            const sbSec = readInt(display.getAttribute('data-shortbreak-sec'), NaN);\n            const lbSec = readInt(display.getAttribute('data-longbreak-sec'), NaN);\n            if (Number.isFinite(sbSec)) shortbreakMs = sbSec*1000;\n            if (Number.isFinite(lbSec)) longbreakMs  = lbSec*1000;\n            if (!Number.isFinite(shortbreakMs)) shortbreakMs = readInt(display.getAttribute('data-shortbreak-min'),5)*60*1000;\n            if (!Number.isFinite(longbreakMs))  longbreakMs  = readInt(display.getAttribute('data-longbreak-min'),15)*60*1000;\n\n            const longbreakInterval = readInt(display.getAttribute('data-longbreak-interval'), 3);\n            const cfg = { courseid, wellnessSec, focusMs, shortbreakMs, longbreakMs, longbreakInterval };\n\n            // UI: show interval number\n            const intervalEl = $('pomodoro-interval');\n            if (intervalEl) intervalEl.textContent = String(longbreakInterval);\n\n            let intervalId = null;\n            let channel = null;\n\n            const sendMessage = (msg) => {\n                if (channel) channel.postMessage(msg);\n                else { localStorage.setItem(K.MSG, JSON.stringify({ ...msg, t: now() })); setTimeout(()=>localStorage.removeItem(K.MSG),50); }\n            };\n            const clearTick = () => { if (intervalId) { clearInterval(intervalId); intervalId = null; } };\n            const alarm = () => { try { const a = new Audio('https://www.freespecialeffects.co.uk/soundfx/scifi/electronic.wav'); a.play().catch(()=>{}); } catch {} };\n            const setPhase = (p,k) => { localStorage.setItem(K.PHASE,p); if(k) localStorage.setItem(K.BREAKKIND,k); else localStorage.removeItem(K.BREAKKIND); };\n            const getPhase = () => localStorage.getItem(K.PHASE) || '';\n            const ajax = (name,args) => Ajax.call([{methodname:name,args}])[0].catch(Notification.exception);\n            const nextIsLongBreak = (c,i) => i>0 && c>0 && (c%i)===0;\n\n            const startLocalTimer = (endTs, el, onDone) => {\n                if (!el || !Number.isFinite(endTs)) return;\n                if (endTs <= now()) { localStorage.removeItem(K.END); localStorage.setItem(K.RUNNING,'0'); return; }\n                clearTick();\n                const tick=()=>{ const left=endTs-now(); if(left<=0){ clearTick(); el.textContent='00:00'; localStorage.removeItem(K.END); localStorage.setItem(K.RUNNING,'0'); sendMessage({type:'stopped'}); if(onDone) onDone(); return;} el.textContent=fmt(left); };\n                tick(); intervalId=setInterval(tick,1000);\n            };\n            const stopAndReset = (el, play=false)=>{ clearTick(); localStorage.removeItem(K.END); localStorage.setItem(K.RUNNING,'0'); sendMessage({type:'stopped'}); if(el) el.textContent='00:00'; if(play) alarm(); };\n            const handleMessage = (msg, el)=>{ if(!msg) return; if(msg.type==='start'&&msg.end){ startLocalTimer(Number(msg.end),el); localStorage.setItem(K.END,String(msg.end)); localStorage.setItem(K.RUNNING,'1'); return;} if(msg.type==='stop'||msg.type==='stopped'){ if(localStorage.getItem(K.END)) stopAndReset(el,false);} };\n\n            const openDlg=(d)=>{ if(d&&typeof d.showModal==='function') d.showModal(); };\n            const closeDlg=(d)=>{ if(d&&d.open) d.close(); };\n\n            const startWellness = (onAfter)=>{\n                setPhase('wellness');\n                const dlg=$('wellness-modal'); const cd=$('wellness-countdown');\n                if(!dlg||!cd){ onAfter(); return; }\n                const end=now()+cfg.wellnessSec*1000;\n                openDlg(dlg);\n                startLocalTimer(end,cd,()=>{ closeDlg(dlg); onAfter(); });\n                const skip=$('skip-wellness');\n                if(skip){ skip.type='button'; skip.onclick=(e)=>{ e.preventDefault(); e.stopPropagation(); closeDlg(dlg); onAfter(); }; }\n            };\n\n            const startBreak=(el,ms,kind)=>{\n                setPhase('break',kind);\n                const dlg=$('break-modal'); const cd=$('break-countdown');\n                if(cd) cd.textContent=fmt(ms); openDlg(dlg);\n                const end=now()+ms;\n                startLocalTimer(end, cd||el, ()=>{ alarm(); closeDlg(dlg); stopAndReset(el,false); });\n                const ok=$('dismiss-break'); if(ok){ ok.type='button'; ok.onclick=(e)=>{ e.preventDefault(); e.stopPropagation(); closeDlg(dlg); }; }\n            };\n\n            const startFocus=(el,ms)=>{\n                const focusDur = Number.isFinite(ms)&&ms>0 ? ms : 25*60*1000;\n                setPhase('focus');\n                const starttsSec = Math.floor(now()/1000);\n                const end=now()+focusDur;\n                localStorage.setItem(K.END,String(end)); localStorage.setItem(K.RUNNING,'1'); sendMessage({type:'start',end});\n                startLocalTimer(end, el, ()=>{\n                    ajax('block_pomodoro_increment_session',{courseid:cfg.courseid,startts:starttsSec}).then((res)=>{\n                        alarm();\n                        const count = res && typeof res.sessionscount==='number' ? res.sessionscount : 1;\n                        renderTomatoes($('pomodoro-tomatoes'), count, cfg.longbreakInterval);\n                        const isLong = nextIsLongBreak(count, cfg.longbreakInterval);\n                        startBreak(el, isLong ? cfg.longbreakMs : cfg.shortbreakMs, isLong ? 'long' : 'short');\n                    });\n                });\n            };\n\n            // Broadcast channel\n            if (typeof BroadcastChannel!=='undefined') {\n                channel = new BroadcastChannel(K.CHANNEL);\n                channel.onmessage = (e)=>handleMessage(e.data, display);\n            }\n\n            // Initial tomatoes from server\n            ajax('block_pomodoro_get_status', { courseid: cfg.courseid }).then((res)=>{\n                const count = res && typeof res.sessionscount==='number' ? res.sessionscount : 0;\n                renderTomatoes($('pomodoro-tomatoes'), count, cfg.longbreakInterval);\n            });\n\n            // Resume (only if future)\n            const existingRaw = localStorage.getItem(K.END);\n            if (existingRaw !== null) {\n                const existing = Number(existingRaw);\n                const phase = getPhase();\n                const target = phase==='wellness' ? $('wellness-countdown') :\n                    phase==='break'    ? $('break-countdown')    : display;\n                if (Number.isFinite(existing) && existing > now()+250) {\n                    if (phase==='break') openDlg($('break-modal'));\n                    if (phase==='wellness') openDlg($('wellness-modal'));\n                    startLocalTimer(existing, target||display);\n                } else {\n                    localStorage.removeItem(K.END);\n                    localStorage.setItem(K.RUNNING,'0');\n                }\n            }\n\n            // Storage sync for this course key\n            window.addEventListener('storage',(e)=>{\n                if (e.key===K.END) {\n                    if (e.newValue!==null) {\n                        const val=Number(e.newValue);\n                        if (Number.isFinite(val) && val>now()+250) startLocalTimer(val, display);\n                        else { localStorage.removeItem(K.END); localStorage.setItem(K.RUNNING,'0'); }\n                    } else {\n                        localStorage.setItem(K.RUNNING,'0');\n                    }\n                    return;\n                }\n                if (e.key===K.MSG && e.newValue) { try{ handleMessage(JSON.parse(e.newValue), display); }catch{} }\n            });\n\n            const startBtn = $('start'); if (startBtn) { startBtn.type='button'; startBtn.onclick=(e)=>{ e.preventDefault(); e.stopPropagation(); startWellness(()=>startFocus(display, cfg.focusMs)); }; }\n            const stopBtn  = $('stop');  if (stopBtn)  { stopBtn.type='button';  stopBtn.onclick =(e)=>{ e.preventDefault(); e.stopPropagation(); stopAndReset(display,false); }; }\n\n            window.addEventListener('beforeunload', ()=>{ if (channel) channel.close(); });\n        }\n    };\n});\n"],"names":["define","Ajax","Notification","$","id","document","getElementById","now","Date","readInt","v","d","n","parseInt","Number","isFinite","fmt","ms","s","Math","max","floor","toString","padStart","renderTomatoes","el","sessionscount","interval","m","filled","items","Array","from","length","_","i","join","innerHTML","init","display","courseid","getAttribute","K","p","END","RUNNING","PHASE","BREAKKIND","MSG","CHANNEL","scoped","wellnessSec","focusMs","focusSec","NaN","focusMin","dur","mm","split","shortbreakMs","longbreakMs","sbSec","lbSec","longbreakInterval","cfg","intervalEl","textContent","String","intervalId","channel","sendMessage","msg","postMessage","localStorage","setItem","JSON","stringify","t","setTimeout","removeItem","clearTick","clearInterval","alarm","Audio","play","catch","setPhase","k","ajax","name","args","call","methodname","exception","startLocalTimer","endTs","onDone","tick","left","type","setInterval","stopAndReset","arguments","undefined","handleMessage","end","getItem","openDlg","showModal","closeDlg","open","close","startFocus","focusDur","starttsSec","startts","then","res","count","isLong","c","nextIsLongBreak","startBreak","kind","dlg","cd","ok","onclick","e","preventDefault","stopPropagation","BroadcastChannel","onmessage","data","existingRaw","existing","phase","target","window","addEventListener","key","newValue","parse","val","startBtn","onAfter","skip","startWellness","stopBtn"],"mappings":"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"}